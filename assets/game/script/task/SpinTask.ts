import { SettingsController } from 'db://assets/base/components/settingsController/SettingsController';
import { dataManager } from 'db://assets/base/script/data/DataManager';
import { audioManager } from 'db://assets/base/script/manager/AudioManager';
import { httpManager } from 'db://assets/base/script/network/HttpManager';
import { GameTask } from 'db://assets/base/script/tasks/GameTask';
import { taskManager } from 'db://assets/base/script/tasks/TaskManager';
import { TurboMode } from 'db://assets/base/script/types/BaseType';
import { BaseEvent } from 'db://assets/base/script/event/BaseEvent';

import { ReelBlackUI } from 'db://assets/game/components/ReelBlackUI/ReelBlackUI';
import { WinScoreUI } from 'db://assets/game/components/WinScoreUI/WinScoreUI';
import { AudioKey } from 'db://assets/game/script/data/AudioKey';
import { IdleTask } from 'db://assets/game/script/task/IdleTask';
import { SlotData } from 'db://assets/game/script/data/SlotData';
import { SettingsBetInfo } from 'db://assets/base/components/settingsController/SettingsBetInfo';


/**
 * 共用開始轉動流程(成功送出Spin請求)
 */
export class SpinTask extends GameTask {
    protected name: string = 'BaseSpinTask';

    /** 是否購買免費遊戲 */
    public isBuyFg: boolean = false;
    /** 下注金額 */
    public betCredit: number = 0;

    async execute(): Promise<void> {
        // console.log('==========================================新局開始==========================================');

        audioManager().playSound(AudioKey.spinClick);

        //初始化遊戲
        BaseEvent.buyFeatureEnabled.emit(false);//禁用購買功能
        SettingsController.setEnabled.emit(false);
        ReelBlackUI.hide.emit();
        SlotData.fsWildMultiply = 1;//重置免費遊戲 wild倍率
        WinScoreUI.hideWin.emit();//隱藏贏得分數


        //購買免費遊戲強制取消Turbo, 但不跳通知
        if (this.isBuyFg) {
            dataManager().curTurboMode = TurboMode.Normal;
            BaseEvent.setTurboBtnState.emit(TurboMode.Normal);
        }

        //取消自動轉
        if (dataManager().isAutoMode && dataManager().autoSpinCount === 0) {
            dataManager().isAutoMode = false;
        }

        const isMG = dataManager().isMG();
        // if (isMG) {
        //     //先轉型(免費遊戲直接給結果不轉動)
        //     // if (!dataManager().isBuyFg) {
        //     SlotMachine.spin.emit();
        //     // }
        // }

        //判斷要傳送一般spin還是免費spin(檢查一下免費遊戲按下時是否有變更成FS模式)
        let spinID = this.isBuyFg ? 1 : 0;

        //------------------------跑假資料------------------------
        //多重連線
        // const fakeSpinResult = {'game_id':5800,'main_game':{'pay_credit_total':18,'game_result':[[1,19,2],[1,1,1],[1,17,15],[2,18,16],[18,16,1]],'pay_line':[{'pay_line':1,'symbol_id':1,'amount':3,'pay_credit':15,'multiplier':1},{'pay_line':6,'symbol_id':1,'amount':2,'pay_credit':1.5,'multiplier':1},{'pay_line':8,'symbol_id':1,'amount':2,'pay_credit':1.5,'multiplier':1}],'scatter_info':{'id':[20],'position':null,'amount':0,'multiplier':0,'pay_credit':0,'pay_rate':0},'wild_info':null,'scatter_extra':null,'extra':null},'get_sub_game':false,'sub_game':{'game_result':null,'pay_credit_total':0,'over_win':false},'get_jackpot':false,'jackpot':{'jackpot_id':'','jackpot_credit':0,'symbol_id':null},'get_jackpot_increment':false,'jackpot_increment':null,'grand':0,'major':0,'minor':0,'mini':0,'user_credit':500000000,'bet_credit':3,'payout_credit':18,'change_credit':15,'effect_credit':3,'buy_spin':0,'buy_spin_multiplier':1,'extra':null};

        // const fakeSpinResult = {'game_id':5800,'main_game':{'pay_credit_total':0,'game_result':[[1,15,18],[19,2,15],[20,18,19],[20,15,17],[15,17,20]],'pay_line':[],'scatter_info':{'id':[20],'position':[[2,0],[3,0],[4,2]],'amount':3,'multiplier':0,'pay_credit':0,'pay_rate':0},'wild_info':null,'scatter_extra':null,'extra':null},'get_sub_game':true,'sub_game':{'game_result':[{'pay_credit_total':0,'game_result':[[19,17,3],[2,17,18],[18,19,5],[1,17,18],[2,18,16]],'pay_line':[],'scatter_info':null,'wild_info':null,'scatter_extra':null,'extra':{'no_m_add_spin':false,'total_wild_count':0,'wild_pos':null}},{'pay_credit_total':1224,'game_result':[[6,17,19],[19,5,6],[17,5,5],[19,17,1],[0,15,16]],'pay_line':[{'pay_line':6,'symbol_id':5,'amount':3,'pay_credit':72,'multiplier':1}],'scatter_info':null,'wild_info':null,'scatter_extra':null,'extra':{'no_m_add_spin':false,'total_wild_count':1,'wild_pos':[[4,0]]}},{'pay_credit_total':144,'game_result':[[5,19,17],[17,15,1],[0,15,18],[16,18,1],[17,3,18]],'pay_line':[],'scatter_info':null,'wild_info':null,'scatter_extra':null,'extra':{'no_m_add_spin':false,'total_wild_count':2,'wild_pos':[[2,0]]}},{'pay_credit_total':1080,'game_result':[[6,18,19],[18,2,17],[2,18,17],[1,7,2],[15,0,19]],'pay_line':[],'scatter_info':null,'wild_info':null,'scatter_extra':null,'extra':{'no_m_add_spin':false,'total_wild_count':3,'wild_pos':[[4,1]]}},{'pay_credit_total':504,'game_result':[[3,17,18],[17,3,19],[5,6,2],[3,19,17],[15,0,19]],'pay_line':[],'scatter_info':null,'wild_info':null,'scatter_extra':null,'extra':{'no_m_add_spin':false,'total_wild_count':4,'wild_pos':[[4,1]]}},{'pay_credit_total':14.4,'game_result':[[19,3,17],[19,2,15],[19,5,5],[17,3,19],[1,17,15]],'pay_line':[{'pay_line':1,'symbol_id':19,'amount':3,'pay_credit':14.4,'multiplier':1}],'scatter_info':null,'wild_info':null,'scatter_extra':null,'extra':{'no_m_add_spin':false,'total_wild_count':4,'wild_pos':null}},{'pay_credit_total':0,'game_result':[[19,3,17],[18,4,19],[19,5,6],[5,18,17],[19,17,18]],'pay_line':[],'scatter_info':null,'wild_info':null,'scatter_extra':null,'extra':{'no_m_add_spin':false,'total_wild_count':4,'wild_pos':null}},{'pay_credit_total':648,'game_result':[[15,4,1],[5,6,5],[17,3,17],[15,2,19],[0,19,16]],'pay_line':[],'scatter_info':null,'wild_info':null,'scatter_extra':null,'extra':{'no_m_add_spin':false,'total_wild_count':5,'wild_pos':[[4,0]]}},{'pay_credit_total':0,'game_result':[[16,5,5],[15,16,1],[18,19,6],[19,17,3],[3,17,15]],'pay_line':[],'scatter_info':null,'wild_info':null,'scatter_extra':null,'extra':{'no_m_add_spin':false,'total_wild_count':5,'wild_pos':null}},{'pay_credit_total':0,'game_result':[[2,15,18],[5,5,5],[15,16,17],[19,2,15],[15,16,15]],'pay_line':[],'scatter_info':null,'wild_info':null,'scatter_extra':null,'extra':{'no_m_add_spin':false,'total_wild_count':5,'wild_pos':null}},{'pay_credit_total':0,'game_result':[[18,19,1],[17,19,2],[19,17,3],[16,18,1],[2,18,15]],'pay_line':[],'scatter_info':null,'wild_info':null,'scatter_extra':null,'extra':{'no_m_add_spin':false,'total_wild_count':5,'wild_pos':null}},{'pay_credit_total':0,'game_result':[[1,17,18],[5,19,17],[3,17,18],[18,1,17],[3,17,15]],'pay_line':[],'scatter_info':null,'wild_info':null,'scatter_extra':null,'extra':{'no_m_add_spin':false,'total_wild_count':5,'wild_pos':null}},{'pay_credit_total':864,'game_result':[[3,17,18],[2,15,16],[5,5,5],[18,17,0],[2,15,16]],'pay_line':[],'scatter_info':null,'wild_info':null,'scatter_extra':null,'extra':{'no_m_add_spin':false,'total_wild_count':6,'wild_pos':[[3,2]]}},{'pay_credit_total':0,'game_result':[[17,3,17],[18,15,1],[2,1,3],[1,18,17],[19,17,4]],'pay_line':[],'scatter_info':null,'wild_info':null,'scatter_extra':null,'extra':{'no_m_add_spin':false,'total_wild_count':6,'wild_pos':null}},{'pay_credit_total':0,'game_result':[[17,3,17],[19,2,15],[2,19,17],[1,6,2],[5,19,17]],'pay_line':[],'scatter_info':null,'wild_info':null,'scatter_extra':null,'extra':{'no_m_add_spin':false,'total_wild_count':6,'wild_pos':null}},{'pay_credit_total':0,'game_result':[[19,17,3],[2,15,16],[2,15,16],[17,15,2],[18,5,5]],'pay_line':[],'scatter_info':null,'wild_info':null,'scatter_extra':null,'extra':{'no_m_add_spin':false,'total_wild_count':6,'wild_pos':null}},{'pay_credit_total':288,'game_result':[[16,5,18],[19,0,18],[19,2,15],[18,4,19],[19,17,4]],'pay_line':[],'scatter_info':null,'wild_info':null,'scatter_extra':null,'extra':{'no_m_add_spin':false,'total_wild_count':7,'wild_pos':[[1,1]]}},{'pay_credit_total':0,'game_result':[[6,15,16],[3,19,17],[15,18,2],[2,15,6],[16,18,17]],'pay_line':[],'scatter_info':null,'wild_info':null,'scatter_extra':null,'extra':{'no_m_add_spin':false,'total_wild_count':7,'wild_pos':null}},{'pay_credit_total':0,'game_result':[[16,2,15],[3,17,19],[19,17,3],[19,1,17],[18,16,2]],'pay_line':[],'scatter_info':null,'wild_info':null,'scatter_extra':null,'extra':{'no_m_add_spin':false,'total_wild_count':7,'wild_pos':null}},{'pay_credit_total':36,'game_result':[[16,1,15],[1,18,4],[18,4,19],[17,3,19],[17,15,2]],'pay_line':[{'pay_line':3,'symbol_id':1,'amount':2,'pay_credit':36,'multiplier':1}],'scatter_info':null,'wild_info':null,'scatter_extra':null,'extra':{'no_m_add_spin':false,'total_wild_count':7,'wild_pos':null}}],'pay_credit_total':4802.4,'over_win':false},'get_jackpot':false,'jackpot':{'jackpot_id':'','jackpot_credit':0,'symbol_id':null},'get_jackpot_increment':false,'jackpot_increment':null,'grand':0,'major':0,'minor':0,'mini':0,'user_credit':500000719.7,'bet_credit':72,'payout_credit':4802.4,'change_credit':4730.4,'effect_credit':72,'buy_spin':0,'buy_spin_multiplier':1,'extra':null};

        //wild獲得超過數量
        // const fakeSpinResult = {
        //     'game_id': 5800, 'main_game': { 'pay_credit_total': 0, 'game_result': [[20, 15, 19], [18, 20, 16], [15, 20, 17], [18, 4, 19], [15, 20, 17]], 'pay_line': [], 'scatter_info': { 'id': [20], 'position': [[0, 0], [1, 1], [2, 1], [4, 1]], 'amount': 4, 'multiplier': 0, 'pay_credit': 0, 'pay_rate': 0 }, 'wild_info': null, 'scatter_extra': null, 'extra': null }, 'get_sub_game': true,
        //     'sub_game': {
        //         'game_result': [{ 'pay_credit_total': 0, 'game_result': [[19, 1, 15], [18, 2, 17], [3, 15, 19], [15, 2, 19], [1, 17, 15]], 'pay_line': [], 'scatter_info': null, 'wild_info': null, 'scatter_extra': null, 'extra': { 'no_m_add_spin': false, 'total_wild_count': 0, 'wild_pos': null } }, { 'pay_credit_total': 0, 'game_result': [[2, 18, 16], [3, 17, 19], [15, 19, 2], [17, 15, 2], [3, 17, 5]], 'pay_line': [], 'scatter_info': null, 'wild_info': null, 'scatter_extra': null, 'extra': { 'no_m_add_spin': false, 'total_wild_count': 0, 'wild_pos': null } }, { 'pay_credit_total': 0, 'game_result': [[1, 18, 19], [2, 17, 16], [17, 3, 18], [2, 18, 17], [17, 15, 0]], 'pay_line': [], 'scatter_info': null, 'wild_info': null, 'scatter_extra': null, 'extra': { 'no_m_add_spin': true, 'total_wild_count': 1, 'wild_pos': [[4, 2]] } }, { 'pay_credit_total': 27, 'game_result': [[15, 18, 5], [15, 16, 1], [19, 17, 3], [6, 5, 15], [17, 15, 0]], 'pay_line': [], 'scatter_info': null, 'wild_info': null, 'scatter_extra': null, 'extra': { 'no_m_add_spin': false, 'total_wild_count': 2, 'wild_pos': [[4, 2]] } }, { 'pay_credit_total': 0, 'game_result': [[19, 1, 17], [15, 18, 2], [5, 2, 18], [19, 1, 5], [18, 1, 17]], 'pay_line': [], 'scatter_info': null, 'wild_info': null, 'scatter_extra': null, 'extra': { 'no_m_add_spin': false, 'total_wild_count': 2, 'wild_pos': null } }, { 'pay_credit_total': 0, 'game_result': [[18, 4, 16], [15, 1, 18], [17, 15, 1], [17, 1, 18], [18, 1, 16]], 'pay_line': [], 'scatter_info': null, 'wild_info': null, 'scatter_extra': null, 'extra': { 'no_m_add_spin': false, 'total_wild_count': 2, 'wild_pos': null } }, { 'pay_credit_total': 12, 'game_result': [[16, 1, 17], [18, 17, 3], [4, 19, 2], [19, 5, 5], [15, 0, 19]], 'pay_line': [], 'scatter_info': null, 'wild_info': null, 'scatter_extra': null, 'extra': { 'no_m_add_spin': false, 'total_wild_count': 3, 'wild_pos': [[4, 1]] } }, { 'pay_credit_total': 33.6, 'game_result': [[1, 15, 18], [5, 6, 18], [18, 17, 0], [17, 18, 4], [5, 5, 19]], 'pay_line': [{ 'pay_line': 2, 'symbol_id': 18, 'amount': 3, 'pay_credit': 0.6000000000000001, 'multiplier': 1 }], 'scatter_info': null, 'wild_info': null, 'scatter_extra': null, 'extra': { 'no_m_add_spin': false, 'total_wild_count': 4, 'wild_pos': [[2, 2]] } }, { 'pay_credit_total': 54, 'game_result': [[2, 19, 1], [18, 19, 0], [7, 2, 18], [1, 18, 1], [6, 5, 16]], 'pay_line': [{ 'pay_line': 2, 'symbol_id': 1, 'amount': 2, 'pay_credit': 1.5, 'multiplier': 1 }, { 'pay_line': 7, 'symbol_id': 1, 'amount': 2, 'pay_credit': 1.5, 'multiplier': 1 }], 'scatter_info': null, 'wild_info': null, 'scatter_extra': null, 'extra': { 'no_m_add_spin': false, 'total_wild_count': 5, 'wild_pos': [[1, 2]] } }, { 'pay_credit_total': 0.6000000000000001, 'game_result': [[19, 2, 18], [19, 2, 15], [17, 19, 6], [19, 1, 5], [15, 19, 3]], 'pay_line': [{ 'pay_line': 8, 'symbol_id': 19, 'amount': 3, 'pay_credit': 0.6000000000000001, 'multiplier': 1 }], 'scatter_info': null, 'wild_info': null, 'scatter_extra': null, 'extra': { 'no_m_add_spin': false, 'total_wild_count': 5, 'wild_pos': null } }, { 'pay_credit_total': 0, 'game_result': [[6, 5, 17], [1, 18, 17], [2, 15, 16], [3, 17, 19], [18, 1, 16]], 'pay_line': [], 'scatter_info': null, 'wild_info': null, 'scatter_extra': null, 'extra': { 'no_m_add_spin': false, 'total_wild_count': 5, 'wild_pos': null } }, { 'pay_credit_total': 0.6000000000000001, 'game_result': [[1, 17, 18], [2, 17, 15], [2, 17, 15], [15, 16, 1], [16, 15, 19]], 'pay_line': [{ 'pay_line': 0, 'symbol_id': 17, 'amount': 3, 'pay_credit': 0.6000000000000001, 'multiplier': 1 }], 'scatter_info': null, 'wild_info': null, 'scatter_extra': null, 'extra': { 'no_m_add_spin': false, 'total_wild_count': 5, 'wild_pos': null } }, { 'pay_credit_total': 7.5, 'game_result': [[1, 15, 19], [15, 16, 1], [0, 15, 18], [0, 16, 18], [0, 19, 16]], 'pay_line': [{ 'pay_line': 3, 'symbol_id': 15, 'amount': 4, 'pay_credit': 7.5, 'multiplier': 1 }], 'scatter_info': null, 'wild_info': null, 'scatter_extra': null, 'extra': { 'no_m_add_spin': false, 'total_wild_count': 8, 'wild_pos': [[2, 0], [3, 0], [4, 0]] } }, { 'pay_credit_total': 0.6000000000000001, 'game_result': [[17, 19, 1], [18, 4, 19], [16, 17, 19], [2, 15, 5], [5, 19, 17]], 'pay_line': [{ 'pay_line': 4, 'symbol_id': 19, 'amount': 3, 'pay_credit': 0.6000000000000001, 'multiplier': 1 }], 'scatter_info': null, 'wild_info': null, 'scatter_extra': null, 'extra': { 'no_m_add_spin': false, 'total_wild_count': 8, 'wild_pos': null } }, { 'pay_credit_total': 0, 'game_result': [[18, 5, 7], [19, 6, 5], [2, 19, 17], [15, 1, 18], [5, 5, 19]], 'pay_line': [], 'scatter_info': null, 'wild_info': null, 'scatter_extra': null, 'extra': { 'no_m_add_spin': false, 'total_wild_count': 8, 'wild_pos': null } }, { 'pay_credit_total': 0, 'game_result': [[6, 10, 17], [15, 16, 1], [3, 15, 19], [17, 1, 18], [18, 17, 3]], 'pay_line': [], 'scatter_info': null, 'wild_info': null, 'scatter_extra': null, 'extra': { 'no_m_add_spin': false, 'total_wild_count': 8, 'wild_pos': null } }, { 'pay_credit_total': 12, 'game_result': [[17, 3, 17], [2, 17, 16], [5, 18, 4], [1, 17, 18], [18, 0, 15]], 'pay_line': [], 'scatter_info': null, 'wild_info': null, 'scatter_extra': null, 'extra': { 'no_m_add_spin': false, 'total_wild_count': 9, 'wild_pos': [[4, 1]] } }, { 'pay_credit_total': 0, 'game_result': [[18, 19, 1], [2, 15, 16], [17, 19, 5], [4, 19, 2], [18, 3, 17]], 'pay_line': [], 'scatter_info': null, 'wild_info': null, 'scatter_extra': null, 'extra': { 'no_m_add_spin': false, 'total_wild_count': 9, 'wild_pos': null } }, { 'pay_credit_total': 0, 'game_result': [[17, 3, 17], [4, 19, 2], [19, 6, 5], [17, 3, 17], [4, 3, 17]], 'pay_line': [], 'scatter_info': null, 'wild_info': null, 'scatter_extra': null, 'extra': { 'no_m_add_spin': false, 'total_wild_count': 9, 'wild_pos': null } }, { 'pay_credit_total': 0, 'game_result': [[16, 17, 2], [16, 18, 19], [18, 2, 19], [19, 2, 15], [2, 15, 16]], 'pay_line': [], 'scatter_info': null, 'wild_info': null, 'scatter_extra': null, 'extra': { 'no_m_add_spin': false, 'total_wild_count': 9, 'wild_pos': null } }, { 'pay_credit_total': 39, 'game_result': [[3, 16, 1], [19, 0, 18], [19, 5, 5], [16, 2, 15], [5, 16, 17]], 'pay_line': [{ 'pay_line': 5, 'symbol_id': 1, 'amount': 2, 'pay_credit': 1.5, 'multiplier': 1 }, { 'pay_line': 9, 'symbol_id': 1, 'amount': 2, 'pay_credit': 1.5, 'multiplier': 1 }], 'scatter_info': null, 'wild_info': null, 'scatter_extra': null, 'extra': { 'no_m_add_spin': false, 'total_wild_count': 10, 'wild_pos': [[1, 1]] } }, { 'pay_credit_total': 0, 'game_result': [[4, 16, 17], [1, 15, 18], [18, 17, 19], [3, 19, 17], [2, 15, 16]], 'pay_line': [], 'scatter_info': null, 'wild_info': null, 'scatter_extra': null, 'extra': { 'no_m_add_spin': false, 'total_wild_count': 10, 'wild_pos': null } }, { 'pay_credit_total': 3, 'game_result': [[17, 19, 1], [15, 16, 1], [19, 17, 3], [1, 18, 17], [17, 19, 2]], 'pay_line': [{ 'pay_line': 2, 'symbol_id': 1, 'amount': 2, 'pay_credit': 1.5, 'multiplier': 1 }, { 'pay_line': 7, 'symbol_id': 1, 'amount': 2, 'pay_credit': 1.5, 'multiplier': 1 }], 'scatter_info': null, 'wild_info': null, 'scatter_extra': null, 'extra': { 'no_m_add_spin': false, 'total_wild_count': 10, 'wild_pos': null } }, { 'pay_credit_total': 0, 'game_result': [[17, 2, 15], [1, 18, 17], [4, 19, 2], [15, 16, 1], [4, 3, 17]], 'pay_line': [], 'scatter_info': null, 'wild_info': null, 'scatter_extra': null, 'extra': { 'no_m_add_spin': false, 'total_wild_count': 10, 'wild_pos': null } }, { 'pay_credit_total': 0, 'game_result': [[6, 19, 17], [6, 6, 19], [19, 3, 17], [1, 17, 18], [16, 18, 1]], 'pay_line': [], 'scatter_info': null, 'wild_info': null, 'scatter_extra': null, 'extra': { 'no_m_add_spin': false, 'total_wild_count': 10, 'wild_pos': null } }, { 'pay_credit_total': 0, 'game_result': [[3, 17, 18], [19, 17, 1], [15, 1, 18], [1, 18, 19], [15, 2, 18]], 'pay_line': [], 'scatter_info': null, 'wild_info': null, 'scatter_extra': null, 'extra': { 'no_m_add_spin': false, 'total_wild_count': 10, 'wild_pos': null } }, { 'pay_credit_total': 0, 'game_result': [[1, 16, 1], [3, 17, 19], [17, 6, 6], [4, 19, 2], [18, 16, 2]], 'pay_line': [], 'scatter_info': null, 'wild_info': null, 'scatter_extra': null, 'extra': { 'no_m_add_spin': false, 'total_wild_count': 10, 'wild_pos': null } }, { 'pay_credit_total': 3, 'game_result': [[18, 19, 1], [17, 18, 2], [17, 3, 18], [1, 18, 17], [19, 17, 4]], 'pay_line': [{ 'pay_line': 6, 'symbol_id': 18, 'amount': 4, 'pay_credit': 3, 'multiplier': 1 }], 'scatter_info': null, 'wild_info': null, 'scatter_extra': null, 'extra': { 'no_m_add_spin': false, 'total_wild_count': 10, 'wild_pos': null } }, { 'pay_credit_total': 0, 'game_result': [[15, 18, 8], [17, 19, 2], [1, 3, 16], [1, 18, 1], [1, 16, 6]], 'pay_line': [], 'scatter_info': null, 'wild_info': null, 'scatter_extra': null, 'extra': { 'no_m_add_spin': false, 'total_wild_count': 10, 'wild_pos': null } }, { 'pay_credit_total': 0, 'game_result': [[17, 3, 15], [15, 16, 1], [17, 7, 6], [1, 5, 2], [19, 2, 15]], 'pay_line': [], 'scatter_info': null, 'wild_info': null, 'scatter_extra': null, 'extra': { 'no_m_add_spin': false, 'total_wild_count': 10, 'wild_pos': null } }, { 'pay_credit_total': 24, 'game_result': [[17, 3, 17], [1, 18, 17], [17, 5, 18], [18, 17, 0], [15, 16, 1]], 'pay_line': [], 'scatter_info': null, 'wild_info': null, 'scatter_extra': null, 'extra': { 'no_m_add_spin': false, 'total_wild_count': 11, 'wild_pos': [[3, 2]] } }, { 'pay_credit_total': 0, 'game_result': [[17, 16, 2], [1, 18, 17], [17, 18, 3], [15, 16, 1], [1, 5, 2]], 'pay_line': [], 'scatter_info': null, 'wild_info': null, 'scatter_extra': null, 'extra': { 'no_m_add_spin': false, 'total_wild_count': 11, 'wild_pos': null } }, { 'pay_credit_total': 0, 'game_result': [[4, 16, 17], [3, 17, 19], [19, 5, 5], [1, 18, 17], [17, 6, 5]], 'pay_line': [], 'scatter_info': null, 'wild_info': null, 'scatter_extra': null, 'extra': { 'no_m_add_spin': false, 'total_wild_count': 11, 'wild_pos': null } }, { 'pay_credit_total': 0, 'game_result': [[5, 19, 17], [4, 19, 2], [8, 7, 19], [17, 19, 15], [16, 18, 17]], 'pay_line': [], 'scatter_info': null, 'wild_info': null, 'scatter_extra': null, 'extra': { 'no_m_add_spin': false, 'total_wild_count': 11, 'wild_pos': null } }, { 'pay_credit_total': 1.5, 'game_result': [[1, 18, 3], [16, 1, 15], [17, 18, 2], [6, 18, 17], [5, 6, 19]], 'pay_line': [{ 'pay_line': 6, 'symbol_id': 1, 'amount': 2, 'pay_credit': 1.5, 'multiplier': 1 }], 'scatter_info': null, 'wild_info': null, 'scatter_extra': null, 'extra': { 'no_m_add_spin': false, 'total_wild_count': 11, 'wild_pos': null } }, { 'pay_credit_total': 0, 'game_result': [[5, 15, 16], [19, 2, 15], [17, 3, 18], [1, 9, 2], [3, 17, 15]], 'pay_line': [], 'scatter_info': null, 'wild_info': null, 'scatter_extra': null, 'extra': { 'no_m_add_spin': false, 'total_wild_count': 11, 'wild_pos': null } }], 'pay_credit_total': 218.39999999999998, 'over_win': false
        //     },
        //     'get_jackpot': false, 'jackpot': { 'jackpot_id': '', 'jackpot_credit': 0, 'symbol_id': null }, 'get_jackpot_increment': false, 'jackpot_increment': null, 'grand': 0, 'major': 0, 'minor': 0, 'mini': 0, 'user_credit': 500000068.4, 'bet_credit': 150, 'payout_credit': 218.39, 'change_credit': 68.39999999999998, 'effect_credit': 150, 'buy_spin': 1, 'buy_spin_multiplier': 50, 'extra': null
        // };
        // BaseEvent.onSpinResult.emit(fakeSpinResult);
        // //更新玩家餘額(減去spin額度)
        // const newUserCredit = dataManager().userCredit - this.betCredit;
        // SettingsController.refreshCredit.emit(newUserCredit);
        // dataManager().userCredit = newUserCredit;
        // this.finish();
        //------------------------跑假資料------------------------

        //真資料
        httpManager().sendSpin(spinID, (spinResult) => {
            //判斷是否有spin成功回傳資料
            if (spinResult) {
                // console.log('【spin結果】:', spinResult);
                BaseEvent.onSpinResult.emit(spinResult);
                //更新玩家餘額(減去總下注額度)
                const newUserCredit = dataManager().userCredit - this.betCredit;
                SettingsBetInfo.refreshCredit.emit(newUserCredit);
                dataManager().userCredit = newUserCredit;
            } else if (isMG) {
                taskManager().addTask(new IdleTask());//Spin失敗且是MG模式要回idle
            }
            this.finish();
        });
    }

    /**持續更新 */
    update(_deltaTime: number): void {
        // throw new Error('Method not implemented.');
    }
}